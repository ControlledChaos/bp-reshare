/*! bp-reshare - v2.0.1 - 2018-11-25 2:19:28 PM UTC - https://imathi.eu/tag/reshare */
window.bpReshare=window.bpReshare||{},function(a,b){"undefined"!=typeof a.templates&&(a.Posts={start:function(){this.printButtons(),this.scrollToBuddyPress(),b.querySelector("#buddypress .bp-reshare").addEventListener("click",this.reshareAction)},printButtons:function(){var c=b.querySelector(a.commentsAreaID).previousElementSibling,d="add-reshare",e=a.strings.addLink.replace("%i",a.activity.id),f=a.strings.addReshare;a.activity.isSelf?d="disabled":-1!==a.activity.reshares.indexOf(a.params.u.toString())&&(d="remove-reshare",e=a.strings.removeLink.replace("%i",a.activity.id),f=a.strings.removeReshare),this.container=b.createElement("DIV"),this.container.setAttribute("id","buddypress"),this.container.setAttribute("class","buddyreshare activity"),this.container.setAttribute("data-activity-id","activity-"+a.activity.id),this.container.innerHTML=a.templates.reshareButton.replace("%l",e).replace("%r",d).replace("%a",a.activity.id).replace("%u",a.activity.author).replace("%t",f).replace("%c",a.activity.reshares.length),"undefined"!=typeof a.templates.favoritesButton&&(this.container.innerHTML+=a.templates.favoritesButton),c.appendChild(this.container),a.templates.notice&&a.Ajax.feedback(this.container,a.templates.notice,"full")},scrollToBuddyPress:function(){"#activity-"+a.activity.id===window.location.hash&&(location.href="#buddypress")},reshareAction:function(c){c.preventDefault();var d=c.currentTarget,e=d.getAttribute("class").split(" "),f=b.getElementById("buddypress");-1!==e.indexOf("add-reshare")?a.Ajax.post(a.activity.id,{user_id:a.params.u,author_slug:a.activity.author},function(b,c){if(200===b&&c.reshared){d.setAttribute("class",d.getAttribute("class").replace("add-reshare","remove-reshare")),d.setAttribute("href",a.strings.removeLink.replace("%i",a.activity.id)),a.activity.reshares.push(a.params.u);for(var e in d.childNodes)"SPAN"===d.childNodes[e].nodeName&&"count"===d.childNodes[e].getAttribute("class")&&(d.childNodes[e].innerHTML=parseInt(d.childNodes[e].innerHTML,10)+1)}else{var g=a.strings.genericError;c.message&&(g=c.message),a.Ajax.feedback(f,g,"error")}}):-1!==e.indexOf("remove-reshare")&&a.Ajax.remove(a.activity.id,{user_id:a.params.u,author_slug:a.activity.author},function(b,c){if(200===b){d.setAttribute("class",d.getAttribute("class").replace("remove-reshare","add-reshare")),d.setAttribute("href",a.strings.addLink.replace("%i",a.activity.id)),a.activity.reshares.splice(a.activity.reshares.indexOf(a.params.u.toString()),1);for(var e in d.childNodes)"SPAN"===d.childNodes[e].nodeName&&"count"===d.childNodes[e].getAttribute("class")&&(d.childNodes[e].innerHTML=parseInt(d.childNodes[e].innerHTML,10)-1)}else{var g=a.strings.genericError;c.message&&(g=c.message),a.Ajax.feedback(f,g,"error")}})}},window.addEventListener("load",function(){var b=!1;b||(a.Posts.start(),b=!0)}))}(window.bpReshare,window.document);